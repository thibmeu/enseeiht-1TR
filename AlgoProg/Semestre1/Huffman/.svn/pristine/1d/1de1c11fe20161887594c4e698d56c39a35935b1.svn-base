#include "compress-commun.h"

void construct_table_corresp(Tree tree, Binary output[CHAR_MAX], Value* caracs, size_t sizeTree, Byte codeCarac, size_t tailleCode)
{
	if (tree != NULL)
	{
		if (is_leaf_Tree(tree))
		{
			//Binary code;
			destruct_Binary(output+(unsigned char)tree->couple.value);
			Byte codeCarac2 = codeCarac;
			init_fromByte_Binary(output+(unsigned char)tree->couple.value, &codeCarac2, tailleCode);
			//code = NULL;
		}
		else
		{
			construct_table_corresp(tree->left, output, caracs, sizeTree, codeCarac << 1, tailleCode + 1);
			construct_table_corresp(tree->right, output, caracs, sizeTree, (codeCarac << 1) + 1, tailleCode + 1);
		}
	}
}

void print_table_corresp(Binary* tableCorresp)
{
	for (int iCarac = 0; iCarac < CHAR_MAX; iCarac++)
	{
		if (tableCorresp[iCarac]->size != 0)
		{
			printf("%c: ", iCarac);
			print_Binary(tableCorresp[iCarac]);
		}
	}
}


void loadBar(int x, int n, int r, int w)
{
    // Only update r times.
    if ( x % (n/r +1) != 0 ) return;
 
    // Calculuate the ratio of complete-to-incomplete.
    float ratio = x/(float)n;
    int   c     = ratio * w;
 
    // Show the percentage complete.
    printf("%3d%% [", (int)(ratio*100));
 
    // Show the load bar.
    for (int x=0; x<c; x++)
       printf("=");
 
    for (int x=c; x<w; x++)
       printf(" ");
 
    printf("]\r");
    fflush(stdout);
}
